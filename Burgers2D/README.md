This folder contains the code for running the EnSF and LETKF algorithms to estimate solutions of the 2D Burgers’ equation from synthetic observations. The data are generated by numerically solving the 2D Burgers’ equation. It is well known that even smooth initial conditions can develop discontinuities (shocks) in finite time for Burgers’ equation (and hyperbolic PDEs in general). To handle these shocks, we employ strong-stability-preserving Runge–Kutta (SSP-RK) schemes [^1][^2].  

In this work, we consider the scenarios where the observational data is very sparse, which often hinders the data assimilation process. To handle this issue, we incorporate inpaiting techniques[^3][^4][^5] with the EnSF. 

> [!NOTE]
>The implementation of the SSP-RK2 in pytorch are coded in **Burger2D_SSPRK2.py**.  
To run the EnSF algorithm with no inpainting (IP) technique, execute the file **EnSF_2DBurger_SSPRK2_NoIP.ipynb**.  
To run the LETKF algorithm, run the file **LETKF_2DBurger_SSPRK2.ipynb**.  
The EnSF with bi-harmonic and with Navier-Stokes IP are shown in **EnSF_2DBurger_SSPRK2_WithBiHInpainting.ipynb** and **EnSF_2DBurger_SSPRK2_WithNSInpainting.ipynb**, respectively.

>[!IMPORTANT] 
>All above files are in Jupyter Notebook. Users need to install *torch*, *skimage*, *cv2*, *torch_dct*, *joblib*, *sklearn*, and *cvxpy* in advance.

[^1]: Shu, C.W.: TVB uniformly high-order schemes for conservation laws. Math. Comp. 49(179), 105-121 (1987).  
[^2]: Gottlieb, S., Shu, C.-W.: Total variation diminishing Runge-Kutta schemes, Math. Comp. 67 (221), 73-85 (1998).  
[^3]: M. Bertalmio, A. Bertozzi, and G. Sapiro, Navier-stokes, fluid dynamics, and image and video inpainting, Proceedings of the 2001 IEEE Computer Society Conference on Computer Vision and Pattern Recognition. CVPR 2001, 1 (2001), pp. I–I.  
[^4]: S. B. Damelin and N. S. Hoang, On surface completion and image inpainting by biharmonic functions: Numerical aspects, International Journal of Mathematics and Mathematical Sciences, 2018 (2018), p. 3950312.  
[^5]: S. Liang, H. Tran, F. Bao, H. Chipilski, P.J. van Leeuwen, G. Zhang, Ensemble score filter with image inpainting for data assimilation in tracking surface quasi-geostrophic dynamics with partial observations, submitted (https://arxiv.org/abs/2501.12419).
